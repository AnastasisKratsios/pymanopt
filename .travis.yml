dist: xenial

language: python
python:
  - "3.5"
  - "3.6"
  - "3.7"

notifications:
  email: false
  webhooks:
    urls:
      - https://webhooks.gitter.im/e/601eba4ae3738ceb2406
    on_success: change
    on_failure: always
    on_start: never

addons:
  apt:
    update: true

install:
  - pip install --upgrade pip setuptools wheel
  - pip install -q -r dev-requirements.txt
  - pip install -q -r requirements.txt

script:
  - >
    nosetests tests
    --nologcapture
    --verbosity=2
    --with-coverage
    --cover-package=pymanopt
  - flake8 examples pymanopt tests setup.py

after_success:
  - coveralls

deploy:
  provider: pypi
  user: $TWINE_USER
  password: $TWINE_PW
  on:
    tags: true
    repo: pymanopt/pymanopt
  distributions: "sdist bdist_wheel"
  skip_existing: true
